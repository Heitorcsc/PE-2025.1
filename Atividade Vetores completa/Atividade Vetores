#include <stdio.h>
#define TAM 26

typedef struct {
    char nome[100];
    int numero;
    int acidentes;
} Data;

void ColetarDados(Data dados[]);
void encontrarMaioreMenor(Data dados[], int *indMaior, int *indMenor);
void percentualAcidentes(Data dados[]);
double Media(Data dados[]);
void AcimaDaMedia(Data dados[], double media);

int main() {
    Data dados[TAM];

    printf("Coleta de dados de %d estados\n", TAM);
    ColetarDados(dados);

    int indMaior, indMenor;
    encontrarMaioreMenor(dados, &indMaior, &indMenor);
    printf("\nMaior número de acidentes: %s -> %d\n",
           dados[indMaior].nome, dados[indMaior].acidentes);
    printf("Menor número de acidentes:  %s -> %d\n",
           dados[indMenor].nome, dados[indMenor].acidentes);

    percentualAcidentes(dados);

    double media = Media(dados);
    printf("\nMédia nacional de acidentes: %.2f\n", media);

    AcimaDaMedia(dados, media);

    return 0;
}



void ColetarDados(Data dados[]) {
    for (int i = 0; i < TAM; i++) {
        printf("\n=== Estado %d de %d ===\n", i+1, TAM);

        printf("Digite o nome do estado: ");
        scanf(" %99[^\n]", dados[i].nome);

        printf("Digite o número de veículos do estado: ");
        while (scanf("%d", &dados[i].numero) != 1) {
            printf("Entrada inválida. Digite um número inteiro para veículos: ");
            while (getchar() != '\n'); // limpa buffer
        }

        printf("Digite o número de acidentes: ");
        while (scanf("%d", &dados[i].acidentes) != 1) {
            printf("Entrada inválida. Digite um número inteiro para acidentes: ");
            while (getchar() != '\n');
        }
        while (getchar() != '\n'); // consome '\n' remanescente antes do próximo nome
    }
}

void encontrarMaioreMenor(Data dados[], int *indMaior, int *indMenor) {
    *indMaior = 0;
    *indMenor = 0;

    for (int i = 1; i < TAM; i++) {
        if (dados[i].acidentes > dados[*indMaior].acidentes) {
            *indMaior = i;
        }
        if (dados[i].acidentes < dados[*indMenor].acidentes) {
            *indMenor = i;
        }
    }
}

void percentualAcidentes(Data dados[]) {
    printf("\nPercentual de acidentes por número de veículos (por estado):\n");
    for (int i = 0; i < TAM; i++) {
        double percentual = 0.0;

        if (dados[i].numero != 0) {
            percentual = ((double)dados[i].acidentes / dados[i].numero) * 100.0;
        }

        printf("%s | Veículos: %d | Acidentes: %d | Percentual: %.4f%%\n",
               dados[i].nome, dados[i].numero, dados[i].acidentes, percentual);
    }
}

double Media(Data dados[]) {
    int soma = 0;

    for (int i = 0; i < TAM; i++) {
        soma += dados[i].acidentes;
    }

    return (double)soma / TAM;
}

void AcimaDaMedia(Data dados[], double media) {
    printf("\nEstados acima da média de acidentes (média = %.2f):\n", media);
    for (int i = 0; i < TAM; i++) {
        if (dados[i].acidentes > media) {
            printf("%s - %d acidentes\n", dados[i].nome, dados[i].acidentes);
        }
    }
}

